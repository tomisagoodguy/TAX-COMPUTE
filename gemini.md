# 專案目標

本專案旨在建立一個 Excel 試算表，名為「呂寶結餘款分配明細表」，用於自動計算多人不動產交易後的價金分配及收支明細。

# 功能規格 (需求與規則)

這份 Excel 試算表包含以下功能與設計規則：

### 1. 主要輸入
- **價金總額**: 於 `B1` 儲存格輸入，為所有計算的基礎。
- **持分**: 可為最多六人輸入其各自的持分比例。此欄位已設定為分數格式 (`# ?/?`)，因此可接受 `50%`、`0.5` 或 `1/2` 等格式的輸入。

### 2. 自動計算
- **分配金額**: `=持分 * 價金總額`。
- **支出項目合計**: 加總每個人名下的所有支出項目。
- **履保結餘款**: `=分配金額 - 支出項目合計`。此欄位的數字以**醒目紅色字體**顯示。
- **合計欄**: 在最右側有一「合計」欄，用於加總每一橫列的數值，方便使用者快速核對總數。`分配金額` 的合計值會等於 `價金總額`。

### 3. 資料驗證
- **持分總和驗證**: 表格內建資料驗證功能。若所有人的持分加總不等於 `1` (100%)，Excel 將會跳出提示訊息，以確保分配的準確性。

### 4. 支出項目
包含以下可供輸入的支出欄位：
- 仲介費
- 土增稅
- 繳稅匯費
- 地價稅
- 房屋稅
- 稅費分算
- 二胎
- 水電費
- 代書費
- 銀行貸款

### 5. 版面配置與格式
- **版面**: 最終版面採「轉置」設計，即人員為欄，項目為列。
- **框線**: 所有使用到的儲存格均有標準黑色細框線，方便列印閱讀。
- **自動換行**: 標題和項目欄位均設定自動換行，確保文字內容能完整顯示。
- **簽名欄**: 表格最下方附有簽名區塊，包含確認文字、簽名處及日期，供所有共有人簽署確認。
  - `上述金額經各共有人確認無誤。       簽名:`
  - `中華民國        年        月        日`

# 產出檔案
- `呂寶結餘款分配明細表.xlsx`

# 製作方法

我並未直接手動編輯 Excel 檔案，而是透過撰寫並執行一個 Python 腳本 (`create_excel_calculator_transposed.py`) 來自動生成這份試算表。

1.  **使用函式庫**: 腳本主要使用 `openpyxl` 這個 Python 函式庫來建立與操作 Excel 檔案。
2.  **迭代開發**: 整個製作過程是迭代式的。我根據您每一次提出的新需求（如調整版面、增加合計欄、修改格式、加入驗證與簽名欄等），逐步修改 Python 腳本的內容。
3.  **程式化生成**: 腳本的具體工作包含：
    - 建立新的 Excel 工作簿與工作表。
    - 寫入所有靜態文字（如標題、項目名稱）。
    - 插入所有 Excel 公式（如分配金額、合計等）。
    - 設定每個儲存格的詳細格式，包括：
        - **數字格式**: 分數、百分比、千分位逗號。
        - **儲存格樣式**: 背景顏色、字體顏色（如履保結餘款的紅色字）、粗體。
        - **對齊方式**: 水平/垂直置中、自動換行。
        - **框線**: 為表格加上完整的框線。
    - 加入資料驗證規則，以檢查持分總和。
    - 合併儲存格以建立簽名欄。
4.  **執行與產出**: 每次修改完腳本後，我會重新執行它，覆寫並產出最新版本的 `.xlsx` 檔案，直到完成您需要的所有功能。

這種方法的好處是，所有規則和格式都被明確地定義在程式碼中，未來若有需要，可以快速地重製或修改這份 Excel 檔案。