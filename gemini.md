1. 系統架構設計 (Workbook Structure)

整份 Excel 將包含四個主要的工作表 (Sheets)：

【承辦中】(Active Cases)：您的核心工作區。所有正在進行的案件都在此，具備完整的自動化格式與下拉選單。

【結案歸檔】(Archive)：歷史資料庫。當案件結束後，透過「按鈕」一鍵將資料搬移至此，保持承辦中頁面乾淨。

【進度儀表板】(Gantt/Timeline)：視覺化圖表。不需手動輸入，自動讀取「承辦中」的日期，以甘特圖或時間軸顯示未來 7-30 天的代辦事項。

【參數設定】(Settings)：隱藏頁面。存放下拉選單的選項 (如：台北/新北、銀行清單、代辦事項列表)，方便日後維護。

2. 欄位詳細設計 (Column Schema)

為了達到您要求的「直觀」與「美感」，我將欄位分為五大區塊，並建議使用顏色區隔標題：

A. 案件基本資料 (淺藍色標題)

買方 / 賣方

縣市：(下拉選單: 台北/新北)

手續地點：(下拉選單: 士林/內湖)

類型：(下拉選單: 一般/自用)

成交價：(數值格式，自動加千分位)

B. 財務與貸款 (淺綠色標題)

買方銀行：(下拉選單 + 可手動輸入)

買方貸款：(文字/備註)

核貸金額：(建議分為兩欄，或設定格式為「數字」但允許輸入文字。建議：若輸入數字顯示金額，若未核貸顯示紅色「審核中」)

賣方銀行/貸款

代償金額

C. 關鍵時程與規費 (核心區 - 黃色/橘色標題)

這是您最重視的部分，為了能畫出甘特圖，日期格式必須乾淨。

簽約日 (Date)

用印日 (Date)

預收規費_日期 (Date)：建議拆分。日期專用於排序與提醒。

預收規費_金額 (Number)：專用於記帳。(若堅持合在同一格，會導致無法自動計算與畫圖，強烈建議拆開，視覺上可以將邊框合併)

完稅日 (Date)

過戶日 (Date)：智慧格式設定。

若內容包含關鍵字「訴訟」、「卡營登」、「報拆延」，字體自動變粗體紅字且儲存格變色。

交屋日 (Date)

D. 待辦事項矩陣 (Checklist Matrix - 視覺化核心)

您提到的「未完成」與「後續待辦」，若全部擠在一個格子裡(例如: "BS用印, 規費, 設定")，眼睛很難瞬間判斷進度。

我建議設計為 「進度方格 (Checkbox Grid)」 區域：

設計一系列窄欄位，標題為簡寫：

[買方印] [賣方印] [用印款] [完稅款] [權狀] [規費] [設定] [稅單] [差額] [整過戶]

視覺邏輯：

預設為灰色或紅色底 (表示未完成)。

當您在格子內打「v」或選「OK」，底色自動變綠色。

這樣您一眼掃過去，哪一列還有「紅色區塊」，就是該案件的卡關點。

E. 應注意事項與風控 (紫色標題)

注意事項：(自由文字輸入)

檢核點 (下拉選單: Yes/No/NA)：

[退稅檢查]

[戶籍遷入]

[解約條款]

[水電結算]

3. 自動化功能設計 (Automation)

功能 A：甘特圖/時程表 (Python 生成)

我會用 Python 設定 Excel 的條件式格式化 (Conditional Formatting) 來製作「儲存格甘特圖」。

右側會有一區是以「日期」為標題的長條圖。

如果 今天 接近 完稅日，該格會自動亮起黃燈。

如果 今天 超過 簽約日 且 [買方印] 未打勾，整行亮紅燈警示。

功能 B：一鍵結案 (VBA Macro)

Excel 本身無法單純靠公式將 Row 移到另一個 Sheet。

我會提供一段 VBA 程式碼 給您。您只需在 Excel 中貼上，我就能幫您做一個按鈕「✅ 結案」。

邏輯：點選某案件 -> 按下按鈕 -> 該列資料剪下 -> 貼上到 【結案歸檔】 Sheet 的最下方 -> 刪除原 Sheet 空行。

4. 針對您的特殊需求回應

「貸款提早好的 打設定時要注意提醒銀行立契日不要押」

設計解法：在 [核貸] 欄位旁增加一個自動變色規則。如果 核貸狀態=OK 且 完稅日 還很久，自動跳出提示文字或變色提醒「注意立契日」。

「未完成通常包括...要如何設計選取」

設計解法：如上述 D. 待辦事項矩陣。用「勾選」代替「輸入」。這比下拉選單選一長串文字更直觀，也更有成就感（像在消滅待辦事項）。

下一步 (Next Step)

如果上述的規格設計（特別是將「預收規費」拆欄位、以及「待辦事項矩陣化」）您同意的話，我將開始執行以下動作：

Python 程式撰寫：生成包含所有格式、下拉選單、條件格式化顏色的 Excel 範本。

VBA 代碼生成：提供「結案按鈕」的程式碼與安裝教學。

模擬資料：我會將您上傳的 承辦中.csv 資料嘗試填入新格式，讓您直接看到成果。

請問您是否同意將「預收規費」分為「日期」與「金額」兩欄？以及是否接受「待辦事項矩陣化」的設計？

# 房地產代書事務管理系統架構與自動化設計詳盡研究報告

## 1. 執行摘要與系統設計哲學

在高度複雜且法規嚴謹的台灣不動產交易環境中，地政士（代書）事務所的案件管理系統不僅僅是資料的記錄工具，更是風險控管與流程優化的核心引擎。本報告旨在針對閣下提出的「案件進度控案 Excel」需求，提供一份詳盡、具備學術深度與實務可操作性的架構設計書。本報告基於閣下提供的承辦中案件數據 ^1^、歷史歸檔資料 ^1^、銀行聯絡清單 ^1^ 以及原始工作表 ^1^，進行了深度的資料探勘與流程分析，並結合現代資料庫正規化理論與使用者體驗（UX）設計原則，構建出一套兼具彈性與嚴謹性的管理系統。

系統的核心設計哲學建立在「例外管理（Management by Exception）」與「視覺化流動（Visual Flow）」兩大支柱之上。傳統的代書作業往往依賴線性文字記錄，容易導致關鍵節點（如完稅日、用印日）的遺漏。本設計透過「矩陣化待辦事項（Checklist Matrix）」與「條件式格式化甘特圖（Conditional Gantt Chart）」的結合，將被動的資料查詢轉化為單一介面上的主動風險提示。

針對閣下提出的架構假設，本報告經過嚴謹分析後給予高度肯定，特別是將「預收規費」拆分為「日期」與「金額」的決策，這是實現後續財務自動化統計與時程可視化的先決條件。此外，本系統採用的四象限架構（承辦中、歸檔、儀表板、參數設定）嚴格遵守了資料輸入（Input）、處理（Process）與輸出（Output）的分離原則，能有效避免隨著案件量增加導致的 Excel 效能衰退與公式錯亂風險。

---

## 2. 系統架構與資料拓撲學分析

Excel 作為交易管理系統的載體，其架構的穩定性取決於工作表（Worksheet）的功能劃分。混淆數據輸入與數據展示是造成試算表崩潰的主因。因此，本系統採用嚴格的四層式資料拓撲結構。

### 2.1 核心工作區：【承辦中】(Active Cases) 的動態邏輯

【承辦中】工作表是系統的心臟，其設計必須考量高頻率的讀寫操作與即時的狀態反饋。根據提供的 raw data ^1^，目前的資料包含買賣雙方姓名、簽約日、完稅日等關鍵欄位，但也混雜了非結構化的備註資訊（如「稅單好了 塗二胎」）。

在此層級，資料必須具備「強型別（Strong Typing）」特徵。每一列代表一個獨立的交易案件（Transaction Instance），每一欄則代表特定的屬性。為了支援閣下期望的自動化甘特圖，此處的日期欄位必須嚴格限制為 Excel 序列值（Serial Date），而非文字格式。

| **欄位屬性**         | **設計原則與數據治理**                                                                                       |
| -------------------------- | ------------------------------------------------------------------------------------------------------------------ |
| **唯一識別碼 (UID)** | 建議新增隱藏欄位「案號」，作為連結各工作表的錨點，避免因姓名重複（如常見姓名）導致的資料誤植。                     |
| **動態下拉選單**     | 針對「銀行」、「承辦人員」等欄位，必須透過 `INDIRECT`或 `XLOOKUP`連結至【參數設定】頁面，確保資料一致性。      |
| **條件格式化觸發器** | 此頁面將埋設大量的布林邏輯（Boolean Logic），例如當 `[核貸狀態]="OK"`且 `[完稅日]`為空時，觸發特定儲存格變色。 |

### 2.2 歷史資料庫：【結案歸檔】(Archive) 的靜態保存

根據提供的結案資料 ^1^，歷史數據包含如「黃曉梅」案的交屋細節與水電結算紀錄。歸檔頁面的設計邏輯與承辦中頁面截然不同，它是一個唯讀（Read-Only）的資料倉儲（Data Warehouse）。

當案件透過 VBA 巨集從【承辦中】遷移至【結案歸檔】時，系統將執行「去公式化（Paste Values）」操作。這一動作至關重要，因為若保留原始公式，當【參數設定】中的銀行聯絡人或費率發生變更時，歷史案件的紀錄可能會被錯誤地「更新」，破壞檔案的證據力。此外，歸檔頁面也是進行縱向數據分析的基礎，例如分析「2024年度平均過戶天數」或「各銀行核貸速度排名」^2^。

### 2.3 視覺化層：【進度儀表板】(Dashboard) 的抽象表現

儀表板層不存儲任何實體資料，它僅僅是【承辦中】資料的「投影」。利用 Excel 的動態陣列函數（如 `FILTER`、`SORT`）或 Python 生成的條件格式化規則，此頁面將抽象的日期數據轉化為直觀的時間軸。

根據 ^3^ 與 ^3^ 的研究，動態甘特圖的實現依賴於 `AND` 邏輯運算。例如，時間軸上的某一格若介於 `[簽約日]` 與 `[完稅日]` 之間，則自動填色。這層設計將解決閣下對於「直觀」與「美感」的要求，讓管理者能一眼識別出哪些案件的進度條（Bar）過長，暗示著潛在的延宕。

### 2.4 控制中樞：【參數設定】(Settings) 的正規化管理

這是系統的後台。根據提供的銀行資料 ^1^ 與 ^1^，目前的銀行資訊極為混亂，例如「兆豐 世貿 陶融 010134@...」被擠在同一個儲存格中。在【參數設定】頁面，我們必須建立標準化的「銀行主檔（Bank Master Data）」，將銀行名稱、分行、聯絡人、Email 拆解為獨立欄位。這不僅方便日後維護，更能支援自動化郵件發送功能的擴充。

---

## 3. 詳細欄位設計與資料正規化策略

為了達成閣下要求的「詳盡」與「具洞察力」，我們將針對五大區塊進行微觀級別的欄位定義，並結合實際案例數據進行壓力測試。

### 3.1 A 區：案件基本資料 (Identity Layer) - 淺藍色標題

此區塊定義了案件的「身份」。除了基本的買賣方姓名外，地點與類型的選擇將直接驅動後續的風險檢查邏輯。

* **縣市 (City/Region):**
  * **資料來源:** ^1^ 顯示目前主要為「台北」與「新北」。
  * **設計洞察:** 雖然目前僅有雙北，但在【參數設定】中應預留「桃園」、「基隆」等選項。更重要的是，此欄位應連動「公定契紙」的格式檢查邏輯，不同縣市的報稅流程微細差異可透過此欄位進行後續的 VBA 判斷。
* **類型 (Transaction Type):**
  * **資料驗證:** 根據 ^1^，交易類型包含「一般」、「自用」、「換約」、「京站」（地上權案）。
  * **邏輯連動:** 這是極具關鍵性的欄位。
    * 若選擇  **「自用」** ：系統應在 E 區（風控）自動強制開啟 `[戶籍遷入]` 與 `[重購退稅]` 的檢核點，因為自用稅率對戶籍有嚴格要求 ^1^。
    * 若選擇  **「京站」** ：這代表地上權案件，不涉及土地增值稅但有權利金問題，系統應自動隱藏或灰階化 `[土增稅]` 相關的待辦格子，避免誤導。
    * 若選擇  **「換約」** ：如 ^1^ 中的「陳佳慧」案，這涉及預售屋換約，其流程與成屋截然不同（無過戶，僅更名），系統需切換至「換約專用檢核表」。

### 3.2 B 區：財務與貸款工程 (Liquidity Layer) - 淺綠色標題

資金流是交易中最容易卡關的環節。根據 ^1^ 中的案例「顏鼎承」，買方銀行為「台新」，賣方銀行為「國泰」，這涉及代償與塗銷的複雜交互。

* **買方銀行 (Buyer Bank):**
  * **資料清洗:** 原始資料 ^1^ 顯示銀行資訊非結構化。新系統將採用 **雙層下拉選單** 或  **可搜尋下拉選單 (Searchable Dropdown)** 。
  * **實作:** 在【參數設定】建立正規化表格：

| **銀行代碼** | **分行** | **聯絡人** | **Email**    |
| ------------------ | -------------- | ---------------- | ------------------ |
| 兆豐               | 世貿           | 陶融             | 010134@megabank... |
| 富邦               | 內科           | 陶融             | 010134@megabank... |

```
*   **使用者體驗:** 在 A 區輸入時，使用者若鍵入 "兆豐"，下拉選單應自動篩選出所有兆豐的分行與視窗，解決  中資訊散落的問題。
```

* **核貸金額與狀態 (Loan Status):**
  * **複合顯示邏輯:** 針對閣下需求「若輸入數字顯示金額，若未核貸顯示紅色『審核中』」。這可以透過 **Excel 自訂數值格式 (Custom Number Formatting)** 實現，無需複雜公式。
  * **格式代碼:** `[="Pending"]"審核中";#,##0`。當使用者輸入文字 "Pending" 時，Excel 自動將其渲染為紅色粗體的 "審核中"；輸入數字則顯示標準金額。
  * **風險預警:** 針對閣下特別提到的風險——「貸款提早好，但要注意立契日」。我們將在此欄位加入條件格式化：
    * **規則:** `AND([核貸狀態]="OK", [完稅日]="")`
    * **效果:** 儲存格背景變為  **亮紫色** ，並浮現提示文字（透過資料驗證的輸入訊息功能）：「⚠️ 貸款已准，請注意立契日是否需壓後！」。這直接回應了 ^1^ 中「何玉靈房地合一」案審核中的情境，防止過早對保導致合約日期矛盾。

### 3.3 C 區：關鍵時程與規費 (Temporal Core) - 黃橘色標題

這是甘特圖的數據源頭，必須保證資料的純淨度。

* **預收規費拆分決策 (Fee Splitting):**
  * **現狀分析:** 許多代書習慣將「10/24收3000元」寫在同一格。這在數據分析上是災難性的。
  * **解決方案:** 絕對必須拆分為 `[預收日期]` (Date) 與 `[預收金額]` (Currency)。
  * **效益:**
    1. **繪圖:** 甘特圖引擎可以讀取 `[預收日期]`，在時間軸上標記一個「菱形」里程碑（Milestone），直觀顯示該案件是否已收費。
    2. **統計:** 月底時，系統可透過 `=SUMIFS()` 函數自動計算本月「預收規費總額」，若混在一起則無法計算。
    3. **視覺整合:** 為了美觀，我們可以將這兩欄的邊框（Border）設為粗外框，中間設為虛線，視覺上它們仍屬於一個「規費區塊」，但在資料庫邏輯上是分離的。
* **特殊狀態關鍵字 (Risk Keywords):**
  * **實作:** 針對 ^1^ 中「藍祐綸」案提到的「卡營登」或「顏鼎承」案的「訴訟」，在 C 區設定全域條件格式化。
  * **公式:** `=OR(ISNUMBER(SEARCH("訴訟", $A2:$Z2)), ISNUMBER(SEARCH("卡營登", $A2:$Z2)))`
  * **效果:** 一旦任何欄位（包含備註）出現這些字眼，整列案件的「案號」背景將閃爍紅色，強迫管理者進行例外管理。

### 3.4 D 區：待辦事項矩陣 (The Checklist Matrix) - 視覺化核心

這部分是本系統最大的創新點，將傳統的下拉選單轉化為「視覺熱圖（Visual Heatmap）」。

* **設計理念:** 傳統 Excel 的「未完成」欄位（如 ^1^ 中的 "BS用印, 規費, 設定"）需要大腦進行「閱讀->解析->判斷」三個步驟。矩陣化設計將其轉變為「模式識別（Pattern Recognition）」，大腦只需判斷「顏色斷點」。
* **欄位定義:** 根據閣下需求與代書實務，我們將其標準化為 10 個布林值欄位：
  1. **[買方印]** (Buyer Seal)
  2. **[賣方印]** (Seller Seal)
  3. **[用印款]** (Signing Payment)
  4. **[完稅款]** (Tax Payment)
  5. **[權狀]** (Deed Retrieval)
  6. **[規費]** (Gov Fees)
  7. **[設定]** (Mortgage Setting)
  8. **[稅單]** (Tax Bill Issued)
  9. **[差額]** (Price Difference Settlement)
  10. **[整過戶]** (Transfer & Registration)
* **技術實作 (Checkbox vs. Wingdings):**
  * **選項 A (Excel 365 新功能):** 插入 -> 核取方塊（Insert Checkbox）。這是最優解，因為它將 TRUE/FALSE 值直接嵌入儲存格，便於公式運算 ^4^。
  * **選項 B (相容模式):** 若需相容舊版，建議將字型設為 `Wingdings 2`，輸入 "P" 會顯示為 "打勾"，輸入 "O" 顯示為 "叉叉"。
* **視覺邏輯 (The Flow):**
  * **預設狀態:** 淺灰色底（表示未完成）。
  * **完成狀態:** 綠色底（表示已完成）。
  * **異常檢測:** 利用條件格式化偵測「跳躍式進度」。例如，若 `[稅單]` 尚未打勾，但 `[完稅款]` 已經打勾，這在邏輯上可能不合理（除非先墊付）。系統可將此異常邏輯標記為黃色，提醒代書確認程序。
  * **卡關點識別:** 當管理者掃視整個 D 區時，若發現某一列在 `[設定]` 欄位呈現紅色，而其他案件都已變綠，該「紅色區塊」即為瓶頸所在（例如銀行核貸慢或抵押權設定文件缺漏）。

### 3.5 E 區：應注意事項與風控 (Compliance & Risk) - 紫色標題

此區塊處理非標準化的例外狀況，這是代書專業價值的體現。

* **檢核點矩陣 (Checkpoints):**
  * **[退稅檢查]:** 針對「自用」或「重購退稅」案件（如 ^1^ 中的「鄭雅馨」案），此欄位必須強制確認。
  * **[戶籍遷入]:** 連結 A 區的「自用」類型。若 A 區選自用，此欄若未打勾，系統應在「完稅日」接近時發出強烈警示。
  * **[解約條款]:** 針對 ^1^ 中提到的「8成解約」條款，若此欄位為 YES，則整列邊框變為紫色粗體，提醒代書此案有解約風險，需隨時監控貸款成數。
  * **[輻射/海砂檢測]:** 根據 ^1^ 資料，部分案件（如「李俊緯」案）備註了「輻射檢測O」。建議新增一個 `[特殊檢測]` 欄位，下拉選單包含「輻射」、「氯離子」、「無」。
* **自由備註 (Free Text):**
  * 雖然我們強調結構化，但仍需保留一欄寬欄位的備註，用於記錄如「買方出國授權書」、「屋主印鑑證明缺漏」等非典型狀況。

---

## 4. 自動化功能架構設計

### 4.1 Python 生成甘特圖邏輯 (Functional Logic for Timeline)

雖然閣下提到使用 Python 生成，但為了讓 Excel 在交付後仍能動態運作，Python 的角色應是「建構者（Builder）」，負責寫入 Excel 的  **條件格式化規則 (Conditional Formatting Rules)** 。以下是這些規則的邏輯核心：

* **目標:** 在儀表板頁面（K欄至 AZ欄）顯示時間軸。
* **公式邏輯:**
  * 定義變數：`Start_Date` (簽約日), `End_Date` (交屋日), `Current_Col_Date` (儀表板上方日期的該欄日期)。
  * **規則 1 (專案期間):** `=AND(Current_Col_Date >= Start_Date, Current_Col_Date <= End_Date)` -> 填滿藍色。
  * **規則 2 (今日線):** `=Current_Col_Date = TODAY()` -> 填滿亮黃色，並畫出紅色右邊框。這讓代書每天打開檔案，都能看到一條垂直的「今日線」切過所有案件，清楚知道目前位於進度的哪個位置。
  * **規則 3 (逾期警示 - 交通號誌邏輯):**
    * **黃燈:** `=AND(TODAY() >= [完稅日]-3, [完稅款]=FALSE)` -> 若今天距離完稅日不到3天且未完稅，該日期格變橘色。
    * **紅燈:** `=AND(TODAY() > [簽約日]+45, [整過戶]=FALSE)` -> 若簽約超過45天仍未過戶，顯示嚴重滯後。

### 4.2 VBA 一鍵結案模組 (The Archiving Engine)

這段程式碼是保持【承辦中】頁面乾淨的關鍵。根據 ^6^ 的技術文獻，我們設計如下的 VBA 邏輯：

* **觸發條件:** 使用者在該列點選，並按下浮動按鈕「✅ 結案」。
* **安全檢查 (Safety Interlocks):**
  * 程式首先檢查 D 區的 `[整過戶]` 是否為 TRUE。若否，彈出 MsgBox "案件尚未完成過戶程序，是否強制結案？"。
  * 檢查 `[交屋日]` 是否已填寫。
* **資料搬移 (Migration Sequence):**
  1. 鎖定來源列 (`ActiveCell.EntireRow`)。
  2. 計算【結案歸檔】頁面的最後空白列 (`ArchiveSheet.Cells(Rows.Count, 1).End(xlUp).Row + 1`)。
  3. **關鍵步驟 - 數值化 (Paste Values):** 複製來源列 -> 在目標列執行 `PasteSpecial Paste:=xlPasteValues`。這步至關重要，它移除了所有公式與下拉選單，將動態資料「凍結」為靜態歷史紀錄，大幅縮減檔案體積並防止連結失效。
  4. 刪除來源列 (`SourceRow.Delete`)。
  5. **排序優化:** 自動對【結案歸檔】頁面依據 `[結案日期]` 進行降冪排序，確保最新結案的資料在最上方。

---

## 5. 資料遷移與整合策略 (Data Migration)

針對閣下現有的 CSV 資料，我們制定了詳細的遷移計畫，以確保新舊系統無縫接軌。

### 5.1 銀行資料清洗 (Bank Data Normalization)

目前的銀行資料 ^1^ 混雜了多種格式，例如「富邦 俊平 chunping.lee...」與「兆豐 世貿 陶融...」。

* **清洗策略:** 利用 Power Query 或 Python script 進行正則表達式（Regex）提取。
  * 模式識別：`(銀行名)\s+(分行名)?\s+(人名)?\s+([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)`
  * 目標：將 ^1^ 轉化為標準的關聯式表格，存入【參數設定】頁面。這將解決目前找不到聯絡人 Email 的痛點。

### 5.2 歷史案件導入

* 針對 ^1^ 中的歷史案件（如「黃曉梅」、「溫世航」），雖然缺乏 D 區的詳細矩陣數據，但擁有關鍵的日期欄位。
* **導入邏輯:** 將這些資料直接寫入【結案歸檔】頁面。對於缺失的「矩陣」欄位，預設填入 "TRUE" 或 "N/A"，以保持資料庫的完整性，不影響後續的統計分析。

---

## 6. 結論與下一步

本報告所規劃的「矩陣式房地產代書管理系統」，不僅僅是對 Excel 表格的美化，而是一次徹底的流程再造（BPR）。透過將「預收規費」拆分實現財務可視化，利用「待辦事項矩陣」實現進度直觀化，並透過「四層式架構」確保系統的強健性與擴充性。

這套系統將解決 ^1^ 中呈現的資訊混亂問題，將「備註」中的關鍵風險（如卡營登、訴訟）轉化為系統級的自動警示。對於代書而言，這意味著從「記憶依賴」轉向「系統依賴」，大幅降低人為疏失的風險。

### 建議執行步驟 (Next Steps)

1. **確認規格:** 請閣下確認上述 D 區的 10 個矩陣欄位是否涵蓋所有關鍵節點？
2. **Python 腳本開發:** 我將著手撰寫 Python 腳本，不僅生成 Excel 框架，還會預先寫入上述的條件格式化規則與資料驗證清單。
3. **VBA 部署:** 撰寫並測試「一鍵結案」按鈕的穩定性，特別是在處理大量資料時的效能表現。

此架構書已為後續的開發工作奠定了堅實的理論與實務基礎。

---

# 詳細附錄：針對特定使用者限制的深入分析

### 為什麼「規費欄位拆分」是絕對必要的？ (Why Split Columns?)

閣下詢問是否同意將「預收規費」拆分為日期與金額。

分析: 將兩者合併（例如在儲存格輸入 "10/24 $3000"）是造成 Excel 系統技術債（Technical Debt）的主因。

1. **排序失效:** Excel 會將其視為文字字串，導致無法按日期先後排序案件。
2. **計算癱瘓:** 無法使用 `=SUM()` 計算當月總規費收入，財務統計需依賴人工計算機。
3. 甘特圖斷鏈: 時間軸公式依賴 ISNUMBER() 判斷日期，混合文字將導致該案件在時間軸上「隱形」。
   結論: 必須拆分。為了視覺整合，我們將對這兩欄應用「粗外框線」，使其在視覺上像是一個單元，但在資料結構上保持獨立。

### 「矩陣」設計優於「下拉選單」的認知心理學依據

閣下詢問矩陣設計是否優於在一個格子內選取未完成項目。

分析:

* **下拉選單 (Dropdown of Shame):** 顯示的是「負面表列」（還沒做什麼）。使用者必須點擊才能看到內容，且無法一眼比較多個案件的差異。
* **矩陣 (Grid of Progress):** 顯示的是「正面流動」。當代書掃視螢幕時，大腦進行的是「模式識別」。如果有 5 個案件的 `[稅單]` 欄位都是紅色，而其他欄位是綠色，管理者能瞬間秒懂：「稅捐處卡關了」。這種「橫向對比」與「縱向掃描」的能力，是下拉選單無法提供的。這正是所謂的「資訊輻射體（Information Radiator）」設計原則。

### 處理「貸款已准但勿壓日期」的風控邏輯

閣下擔憂：「貸款提早好，打設定時要注意提醒銀行立契日不要押」。

系統解法:

我們不依賴人腦記憶，而是依賴系統邏輯。

* **觸發條件:** `[核貸狀態]="OK"` (或金額) **且** `[完稅日]` 為空白 (表示尚未進入過戶尾聲)。
* **執行動作:** 在 `[核貸狀態]` 旁的備註欄或該儲存格本身，觸發條件格式化，顯示  **亮紫色粗體** 。
* **輔助公式:** 在 E 區備註欄自動生成文字：`=IF(AND(ISNUMBER([核貸金額]), [完稅日]=""), "⚠️ 貸款已准：請註記勿壓立契日", "")`。這將風險提示直接推送到使用者的視線中心。
